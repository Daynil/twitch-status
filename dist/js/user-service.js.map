{"version":3,"sources":["user-service.ts"],"names":["TwitchUser","TwitchUser.constructor","UserService","UserService.constructor","UserService.filtering","UserService.filterLive","UserService.removeDupes","UserService.getChannels","UserService.getLiveStreamInfo","UserService.getCoding","UserService.handleError"],"mappings":"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","file":"user-service.js","sourcesContent":["import { Http, HTTP_PROVIDERS } from 'angular2/http';\r\nimport { Observable } from 'angular2/angular2';\r\nimport { Injectable } from 'angular2/core';\r\n\r\nexport class TwitchUser {\r\n\ticonUrl: string;\r\n\tpopularity: number;  // Stream view count, for sorting\r\n\t\r\n\tisLive: boolean;\r\n\tdescription: string;\r\n\tviewers: number;\r\n\tpreviewUrl: string;\r\n\t\r\n\tconstructor(public name: string, public channelUrl: string) { }\r\n}\r\n\r\n@Injectable()\r\nexport class UserService {\r\n\tbaseUrl = 'https://api.twitch.tv/kraken/';\r\n\t\r\n\ttwitchUserList: TwitchUser[] = [];\r\n\tfilteredUserList: TwitchUser[] = [];\r\n\tliveFilter: string = \"All\";\r\n\ttwitchIcon = 'http://www-cdn.jtvnw.net/images/xarth/footer_glitch.png';\r\n\t\r\n\tconstructor (public http: Http) {\r\n\t\tthis.getChannels('medrybw', '1')\r\n\t\t\t.subscribe( \r\n\t\t\t\tchannelInfo => {\r\n\t\t\t\t\tlet baseObject = channelInfo.channels[0];\r\n\t\t\t\t\tlet alwaysLive = new TwitchUser(baseObject.display_name, baseObject.url);\r\n\t\t\t\t\talwaysLive.iconUrl = baseObject.logo;\r\n\t\t\t\t\talwaysLive.popularity = baseObject.views;\r\n\t\t\t\t\tthis.getLiveStreamInfo(alwaysLive.name.toLowerCase())\r\n\t\t\t\t\t\t.subscribe(\r\n\t\t\t\t\t\t\tstreamInfo => {\r\n\t\t\t\t\t\t\t\talwaysLive.isLive = (streamInfo.stream) ? true : false;\r\n\t\t\t\t\t\t\t\tif (alwaysLive.isLive) {\r\n\t\t\t\t\t\t\t\t\talwaysLive.description = streamInfo.stream.channel.status;\r\n\t\t\t\t\t\t\t\t\talwaysLive.viewers = streamInfo.stream.viewers;\r\n\t\t\t\t\t\t\t\t\tif (streamInfo.preview) alwaysLive.previewUrl = streamInfo.preview.small;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.twitchUserList.push(alwaysLive);\r\n\t\t\t\t\t\t\t\tthis.filteredUserList.push(alwaysLive);\r\n\t\t\t\t\t\t\t\tconsole.log(this.twitchUserList);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terr => this.handleError(err)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\terr => this.handleError(err)\r\n\t\t\t);\r\n\t\t}\r\n\t\r\n\tfiltering(filterText: string) {\r\n\t\tlet currUserList;\r\n\t\tswitch (this.liveFilter) {\r\n\t\t\tcase \"All\":\r\n\t\t\t\tcurrUserList = this.twitchUserList;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Live\":\r\n\t\t\t\tcurrUserList = this.twitchUserList.filter( user => {return user.isLive} );\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Offline\":\r\n\t\t\t\tcurrUserList = this.twitchUserList.filter( user => {return !user.isLive} );\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (filterText.length === 0) this.filteredUserList = currUserList;\r\n\t\telse {\r\n\t\t\tthis.filteredUserList = currUserList.filter(\r\n\t\t\t\tuser => {\r\n\t\t\t\t\tlet regText = \"\";\r\n\t\t\t\t\tfilterText.toLowerCase().split(\"\").map( letter => regText += \".*\" + letter );\r\n\t\t\t\t\tlet filterRegex = new RegExp(regText, \"ig\");\r\n\t\t\t\t\treturn filterRegex.test(user.name);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfilterLive(type: string) {\r\n\t\tswitch (type) {\r\n\t\t\tcase \"All\":\r\n\t\t\t\tthis.liveFilter = \"All\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Live\":\r\n\t\t\t\tthis.liveFilter = \"Live\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Offline\":\r\n\t\t\t\tthis.liveFilter = \"Offline\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.filtering(\"\");\r\n\t}\r\n\t\r\n\tremoveDupes(array: any[]): any[] {\r\n\t\treturn array.filter( (item, currPos) => { return array.indexOf(item) == currPos; } );\r\n\t}\r\n\t\r\n\tgetChannels(query: string, resultLimit: string): Observable<any> {\r\n\t\treturn this.http.get( `${this.baseUrl}search/channels?q=${query}&limit=${resultLimit}` )\r\n\t\t\t\t\t\t.map(res => res.json());\r\n\t}\r\n\t\r\n\tgetLiveStreamInfo(channelName: string): Observable<any> {\r\n\t\treturn this.http.get( `${this.baseUrl}streams/${channelName}` )\r\n\t\t\t\t\t\t.map(res => res.json());\r\n\t}\r\n\t\r\n\tgetCoding(amount: string) {\r\n\t\tthis.getChannels('programming', amount)\r\n\t\t\t.subscribe (\r\n\t\t\t\tchannelList => {\r\n\t\t\t\t\tlet channelArray: any[] = channelList.channels;\r\n\t\t\t\t\tchannelArray.map( channel => {\r\n\t\t\t\t\t\tlet userChannel = new TwitchUser(channel.display_name, channel.url);\r\n\t\t\t\t\t\tif (channel.logo) userChannel.iconUrl = channel.logo;\r\n\t\t\t\t\t\telse userChannel.iconUrl = this.twitchIcon;\r\n\t\t\t\t\t\tuserChannel.popularity = channel.views;\r\n\t\t\t\t\t\tthis.getLiveStreamInfo(userChannel.name.toLowerCase())\r\n\t\t\t\t\t\t\t.subscribe(\r\n\t\t\t\t\t\t\t\tstreamInfo => {\r\n\t\t\t\t\t\t\t\t\tuserChannel.isLive = (streamInfo.stream) ? true : false;\r\n\t\t\t\t\t\t\t\t\tif (userChannel.isLive) {\r\n\t\t\t\t\t\t\t\t\t\tuserChannel.description = streamInfo.stream.channel.status;\r\n\t\t\t\t\t\t\t\t\t\tuserChannel.viewers = streamInfo.stream.viewers;\r\n\t\t\t\t\t\t\t\t\t\tif (streamInfo.preview) userChannel.previewUrl = streamInfo.preview.small;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.twitchUserList.push(userChannel);\r\n\t\t\t\t\t\t\t\t\tthis.filteredUserList.push(userChannel);\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\terr => this.handleError(err)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\terr => this.handleError(err)\r\n\t\t\t);\r\n\t}\r\n\t\r\n\thandleError(error) {\r\n\t\tconsole.log('Some problem, yo: ' + error);\r\n\t}\r\n}"],"sourceRoot":"/source/"}